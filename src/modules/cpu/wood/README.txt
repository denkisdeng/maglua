Tim Fal's energy minimization functions
